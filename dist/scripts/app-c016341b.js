"use strict";angular.module("robertkalfas",["ngAnimate","ngCookies","ngTouch","ngSanitize","ngResource","ui.router","mm.foundation","angular-cache"]).config(["$stateProvider","$urlRouterProvider","CacheFactoryProvider",function(e,a,t){e.state("work",{url:"/work/:movie",templateUrl:"app/work/work.html",controller:"WorkCtrl",resolve:{load:["Items",function(e){return e.fetch("movies")}],movie:["$stateParams",function(e){return e.movie}]}}).state("contact",{url:"/contact",templateUrl:"app/contact/contact.html",controller:"ContactCtrl"}).state("admin",{url:"/admin",templateUrl:"app/admin/admin.html"}),a.otherwise("/work/"),angular.extend(t.defaults,{maxAge:9e5})}]).run(["$rootScope","$http","CacheFactory",function(e,a,t){var o=$("body");e.$on("$stateChangeStart",function(){o.animate({scrollTop:0},"slow"),o.removeClass()}),e.$on("$stateChangeSuccess",function(){o.addClass("loaded")}),a.defaults.cache=t("defaultCache",{maxAge:9e5,cacheFlushInterval:36e5,deleteOnExpire:"aggressive"})}]),angular.module("robertkalfas").directive("customVideo",function(){return{restrict:"EA",template:'<iframe ng-src="{{source}}" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe>',scope:{source:"="},link:function(e,a){var t=$("body").removeClass("loaded");a.children("iframe").load(function(){t.addClass("loaded")})}}}),angular.module("robertkalfas").controller("NavbarCtrl",function(){$(".nav-bar .toggle-button").click(function(){$(".nav-bar .menu").toggleClass("opened")})}).run(["$rootScope",function(e){e.$on("$stateChangeStart",function(){$(".nav-bar .menu").removeClass("opened")})}]),angular.module("robertkalfas").directive("customImage",function(){return{restrict:"EA",template:'<img ng-src="{{source}}" alt="{{title}}" />',scope:{source:"=",title:"="},link:function(e,a){a.children("img").load(function(){a.addClass("loaded")})}}}),angular.module("robertkalfas").controller("WorkCtrl",["$scope","Items","movie","$sce","Config","$filter",function(e,a,t,o,r,i){function n(){for(var a=0,o=e.movies.length;o>a;a++)if(parseInt(t)===i("idMaker")(e.movies[a].uri))return e.movies[a];return!1}e.idMaker=function(e){return i("idMaker")(e)},("undefined"==typeof e.movies||0===e.movies.length)&&(e.movies=a.query());var s=n();if(t&&s){var l=r.playerUrl+t+"?color=fb101e&title=0&byline=0&portrait=0",c=$("body");c.addClass("video-view"),e.movie={src:o.trustAsResourceUrl(l),title:s.name,description:s.description}}}]),angular.module("robertkalfas").controller("MainCtrl",function(){}),angular.module("robertkalfas").controller("ContactCtrl",function(){$("img").load(function(){$(this).parent().addClass("loaded")})}),angular.module("robertkalfas").factory("Items",["$q","$http","Config","CacheFactory","$filter",function(e,a,t,o,r){return{data:{},config:{},missing:[],fetch:function(){var a=this,o=e.defer();return a.sync(t.sourceUrl,"videos").success(function(e){a.data=e,o.resolve()}),o.promise},sync:function(e,t){return a.get(e,{cache:o.get(t)})},syncAll:function(a,o){var r=[],i=this;e.all(a).then(function(e){angular.forEach(e,function(e,a){var t=e.data;i.config.accounts[a].pages||(i.config.accounts[a].pages=Math.ceil(t.total/t.per_page)),r=r.concat(t.data)}),i.data=i.config.videos.length>0?i.filter(r):r,i.data.length<t.perPage,o()})},filter:function(e){for(var a=[],t=0,o=e.length;o>t;t++)for(var i=e[t],n=0,s=this.config.videos.length;s>n;n++){var l=r("idMaker")(i.uri);parseInt(this.config.videos[n])===l?a.push(i):this.missing.push(l)}return a},query:function(){return this.data}}}]).run(["$http","Config",function(e,a){e.defaults.headers.common.Authorization="Bearer "+a.apiToken}]),angular.module("robertkalfas").filter("idMaker",function(){return function(e){return parseInt(e.replace("/videos/",""))}}),angular.module("robertkalfas").service("Config",function(){return{apiUrl:"https://api.vimeo.com/",apiSimpleUrl:"https://vimeo.com/api/v2/",apiToken:"ad142b363bbe2b9e51b478f7fa908d6a",playerUrl:"https://player.vimeo.com/video/",sourceUrl:"http://portfolio-cms.herokuapp.com/videos",perPage:10}}),angular.module("robertkalfas").run(["$templateCache",function(e){e.put("app/admin/admin.html",'<div class="page"><iframe id="admin-page" src="http://portfolio-cms.herokuapp.com/vimeo"></iframe></div>'),e.put("app/contact/contact.html",'<div class="profile page"><div class="image-wrapper"><img class="image" src="assets/images/japa.png"></div><div class="description"><p><strong>HELLO!</strong></p><p>Robert Kalfas is Animator/Motion Graphic Designer based in Cracow.</p><p>Currently working at Pigeon Studio</p><blockquote>I’m always up for new projects and collaborations!</blockquote><p>Say hello at: <a href="mailto:robertkalfas@gmail.com">robertkalfas@gmail.com</a></p></div></div>'),e.put("app/main/main.html","Strona główna"),e.put("app/work/work.html",'<div><div ng-if="movie" ng-class="{ open: movie }" class="movie-container"><h1 class="title" ng-bind-html="movie.title"></h1><div class="video-container"><div class="video-element"><div class="loader"></div><div class="video-wrapper"><custom-video class="video" source="movie.src"></custom-video></div></div></div><div class="description" ng-bind-html="movie.description"></div></div><ul class="movies-container"><li class="movie" ng-repeat="movie in movies"><a ui-sref="work({ movie: idMaker(movie.uri) })" title=""><div class="image-wrapper"><custom-image class="image" source="movie.pictures[2].link" title="movie.name"></custom-image><div class="meta-wrapper"><div class="meta"><span class="title" ng-bind-html="movie.name"></span> <span class="description" ng-bind-html="movie.description"></span></div></div></div></a></li></ul></div>'),e.put("components/navbar/navbar.html",'<nav class="nav-bar" ng-controller="NavbarCtrl"><h1 class="title"><a ui-sref="work({movie:\'\'})"><img src="assets/images/logo.jpg" alt="Robert Kalfas"></a></h1><span class="toggle-button"><span class="divider"></span> <span class="divider"></span> <span class="divider"></span></span><ul class="menu"><li ui-sref-active="active"><a ui-sref="work({movie:\'\'})">Work</a></li><li ui-sref-active="active"><a href="//rkmotiongraphic.tumblr.com" target="_blank">Blog</a></li><li ui-sref-active="active"><a ui-sref="contact">Contact</a></li></ul></nav>')}]);